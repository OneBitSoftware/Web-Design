<script src="../js/jquery.min.js"></script>
<script src="../js/handlebars-v4.0.11.js"></script>
<script type="text/javascript">
    function loadPage(href) {
        let xmlhttp = new XMLHttpRequest();
        xmlhttp.open("GET", href, false);
        xmlhttp.send();
        return xmlhttp.responseText;
    }
</script>
<script>
    Handlebars.registerHelper('amme', function(items){
        let itemsPerColumn = parseInt(items.length / 3);
        let inSymmetricItems = parseInt(items.length % 3);

        let out = '<div class="col-md-4">';

        let firstColumnCount = itemsPerColumn + inSymmetricItems;
        for(let i = 0; i < firstColumnCount; i++){
            out = out + '<div class="hotel-extras-list">' + items[i].name + '</div>';
        }
        out = out + '</div>';
        out = out + '<div class="col-md-4">';


        for(let i = firstColumnCount; i < firstColumnCount + itemsPerColumn; i++){
            out = out + '<div class="hotel-extras-list">' + items[i].name + '</div>';
        }
        out = out + '</div>';
        out = out + '<div class="col-md-4">';
        for(let i = firstColumnCount + itemsPerColumn; i < itemsPerColumn + firstColumnCount + itemsPerColumn; i++){
            out = out + '<div class="hotel-extras-list">' + items[i].name + '</div>';
        }

        return out;
    });
</script>
<script>
    let headSource = loadPage('../head.html');
    let headTemplate = Handlebars.compile(headSource);
    let headContext = {title: "LockChain&trade; Marketplace"};
    document.write(headTemplate(headContext));

    let headerSource = loadPage('../header.html');
    let headerTemplate = Handlebars.compile(headerSource);
    document.write('<body>');
    document.write(headerTemplate());

    // Add more templates for property
    let hotelDetailsSource = loadPage('details.html');
    let hotelDetailsTemplate = Handlebars.compile(hotelDetailsSource);

    function GetURLParameter(sParam)
    {
        let sPageURL = window.location.search.substring(1);
        let sURLVariables = sPageURL.split('&');
        for (let i = 0; i < sURLVariables.length; i++)
        {
            let sParameterName = sURLVariables[i].split('=');
            if (sParameterName[0] === sParam)
            {
                return sParameterName[1];
            }
        }
    }

    let queryId = GetURLParameter("id");
    if(!queryId) {
        location.href = "http://localhost:63342/Lockchain-FrontEnd/Listings/listings.html";
    }
    let hotelDetailsContext = $.get( "http://localhost:8080/api/listings/1" + queryId + "?projection=singleListing", function( data ) {
            document.write(hotelDetailsTemplate(data));
    });


    let footerSource = loadPage('../footer.html');
    let footerTemplate = Handlebars.compile(footerSource);
    document.write(footerTemplate());
    document.write('</body>');
</script>